{
  "active": false,
  "connections": {
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Construct & Execute LLM Prompt",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Store conversation history": {
      "ai_memory": [
        [
          {
            "node": "Construct & Execute LLM Prompt",
            "type": "ai_memory",
            "index": 0
          },
          {
            "node": "When chat message received",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "Construct & Execute LLM Prompt",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-05-01T13:03:34.838Z",
  "id": "kqboskjs7XyrJboQ",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "Deploy Your AI Business Consultant Today â€“ LangChain + Gemini + n8n, 100% Self-Hosted & Ready to Automate",
  "nodes": [
    {
      "parameters": {
        "public": true,
        "initialMessages": "",
        "options": {
          "allowedOrigins": "*",
          "loadPreviousSession": "memory",
          "responseMode": "lastNode"
        }
      },
      "id": "f259587f-8c04-4f20-b178-ccfc60a1399e",
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        20,
        260
      ],
      "webhookId": "b8a5d72c-4172-40e8-b429-d19c2cd6ce54",
      "typeVersion": 1.1
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-exp",
        "options": {
          "temperature": 0.7,
          "safetySettings": {
            "values": [
              {
                "category": "HARM_CATEGORY_SEXUALLY_EXPLICIT",
                "threshold": "BLOCK_NONE"
              }
            ]
          }
        }
      },
      "id": "05cca5b2-38c2-4fc5-8945-479bd71a8bee",
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "position": [
        320,
        500
      ],
      "typeVersion": 1,
      "credentials": {
        "googlePalmApi": {
          "id": "NfT134BOD89kq6qA",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {},
      "id": "de9c03df-94d9-4533-86f6-7675288dc117",
      "name": "Store conversation history",
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "position": [
        520,
        500
      ],
      "notesInFlow": false,
      "typeVersion": 1.3
    },
    {
      "parameters": {
        "code": {
          "execute": {
            "code": "const { PromptTemplate } = require('@langchain/core/prompts');\nconst { ConversationChain } = require('langchain/chains');\nconst { BufferMemory } = require('langchain/memory');\n\nconst template = `\nYou'll be roleplaying as a high-performance Business Automation Consultant. Your character is a seasoned professional with extensive experience optimizing workflows and implementing technology solutions across various industries. You possess analytical brilliance, strategic vision, and a direct communication style that focuses on actionable insights. You're passionate about efficiency, maintain a results-oriented approach, and carry yourself with quiet authority. Your expertise combines deep technical knowledge with practical business acumen, allowing you to translate complex automation concepts into tangible business value.\n\nThe user addresses you as \"Coach,\" and you refer to them as \"Partner.\"\n\nEssential guidelines:\n1. Respond exclusively in English\n2. Never pose questions to the user - eliminate all interrogative forms\n3. Keep responses concise and solution-focused, avoiding theoretical tangents or unnecessary elaboration\n\nContext framework:\n- Conversation history: {chat_history}\n- User's current message: {input}\n\nYour expertise areas include:\n- Workflow optimization and process mapping\n- RPA (Robotic Process Automation) implementation\n- Business intelligence and data analytics integration\n- AI-powered decision support systems\n- Change management for digital transformation\n\nCraft responses that deliver pragmatic automation insights while adhering strictly to these parameters.\n`;\n\nconst prompt = new PromptTemplate({\n  template: template,\n  inputVariables: [\"input\", \"chat_history\"], \n});\n\nconst items = this.getInputData();\nconst model = await this.getInputConnectionData('ai_languageModel', 0);\nconst memory = await this.getInputConnectionData('ai_memory', 0);\nmemory.returnMessages = false;\n\nconst chain = new ConversationChain({ llm:model, memory:memory, prompt: prompt, inputKey:\"input\", outputKey:\"output\"});\nconst output = await chain.call({ input: items[0].json.chatInput});\n\nreturn output;\n"
          }
        },
        "inputs": {
          "input": [
            {
              "type": "main",
              "maxConnections": 1,
              "required": true
            },
            {
              "type": "ai_languageModel",
              "maxConnections": 1,
              "required": true
            },
            {
              "type": "ai_memory",
              "maxConnections": 1,
              "required": true
            }
          ]
        },
        "outputs": {
          "output": [
            {
              "type": "main"
            }
          ]
        }
      },
      "id": "da44bcc7-c522-402a-b2b4-e47866784879",
      "name": "Construct & Execute LLM Prompt",
      "type": "@n8n/n8n-nodes-langchain.code",
      "position": [
        620,
        260
      ],
      "retryOnFail": false,
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "ðŸ‘† **Memory Control**\nAdjust conversation history length in the `Store Conversation History` node  ",
        "height": 140,
        "width": 200
      },
      "id": "202529aa-7ca8-476b-8d05-c99458be08f7",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        480,
        680
      ],
      "typeVersion": 1
    }
  ],
  "pinData": {},
  "repo_name": null,
  "repo_owner": null,
  "repo_path": null,
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2025-04-28T18:16:58.775Z",
      "updatedAt": "2025-04-28T18:16:58.775Z",
      "id": "5fWvt038qtjyrogG",
      "name": "Ready For Production"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-05-05T20:42:16.000Z",
  "versionId": "86f61d1b-ec54-4f12-adda-b96e66b6fa8e"
}